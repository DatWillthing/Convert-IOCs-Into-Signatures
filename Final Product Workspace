##Roadmap for the working script, use as a framework to build upon##

##Import functions module##
(MODULE IMPORT HERE)

$file = read-host "Input full path to file: "

##Convert invalid filetypes to csv##
normalizefile()

##If invalid header detected, replace with valid ones##
normalization()

##Variable Declaration##
$count = 0
$length = $file.length

##Counters##
$SID = 1000000
$TotalSigs = 0
$TotalHashes = 0
$TotalIPs = 0
$TotalSkips = 0
$FirstSID = 700000
$LastSID = 700000
$OutputName = "NotSureYet.rules"

##Iterates through the file and writes pertinent info to suricata rules##
while ($count -lt $length){
  $IP-SRC = "ANY" 
  $IP-DST = "ANY"
  $Type = @()
  $Content = @()
  $Message = @()
  $Reference = @()
  $Classtype = @()
  
  TypeFunction()
  
  echo "alert $IP-SRC ANY <> $IP-DST ANY (msg:`"$Message`"; content:`"$Content`"; reference:$Reference; classtype:$Classtype; sid:$SID; rev:1;)" `n  >> $savedrules\rules.rules
  $SID += 10
  $count += 1
}
