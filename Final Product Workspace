##Import functions module##
(MODULE IMPORT HERE)

##Roadmap for the working script, use as a framework to build upon##
$file = read-host "Input full path to file: "

##Convert invalid filetypes to csv##
XLSXnormalize()

##If invalid header detected, replace with valid ones##
normalization()

##Variable Declaration##
$SID = 1000000
$count = 0
$length = $file.length

##Iterates through the file and writes pertinent info to suricata rules##
while ($count -lt $length){
  $IP = "ANY" ##IP ONLY CHANGES IF TYPE IS AN IP ADDRESS!!##
  $Type = @()
  $Content = @()
  $Message = @()
  $Reference = @()
  $Classtype = @()
  
  TypeFunction()
  
  echo "alert $IP ANY <> ANY ANY (msg:`"$Message`"; content:`"$Content`"; reference:$Reference; classtype:$Classtype; sid:$SID; rev:1;)" `n  >> $savedrules\rules.rules
  $SID += 10
  $count += 1
}
